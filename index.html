<!DOCTYPE html>

<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
        <meta charset="utf-8" />
        <title></title>
        <link rel="stylesheet" href="css/darkly.css">
        <link rel="stylesheet" href="css/style.css">


        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.15/angular-ui-router.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular-animate.min.js"></script>
        <script src="app.js"></script>

    </head>

    <!-- Apply AngularJS app -->
    <body ng-app="formApp">
        <div class="container">

            <!-- Inject views here -->
            <div ui-view></div>
        </div>

    </body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
    var str =
  `
{
  "regiones":[
    {
      "NombreRegion":"Region de Tarapacá",
      "provincias":[
        {
          "Iquique":[
            "Iquique",
            "Alto Hospicio",
            "Pozo Almonte"
          ]
        },
        {
          "Tamarugal":[
            "Camiña",
            "Colchane",
            "Huara",
            "Pica"
          ]
        }
      ]
    },
    {
      "NombreRegion":"Region de Antofagasta",
      "provincias":[
        {
          "Antofagasta":[
            "Antofagasta",
            "Mejillones",
            "Sierra Gorda"
          ]
        },
        {
          "El Loa":[
            "Taltal",
            "Calama",
            "Ollagüe"
          ]
        },
        {
          "Tocopilla":[
            "San Pedro de Atacama",
            "Tocopilla",
            "María Elena"
          ]
        }
      ]
    }
  ]
}
`;
var json = JSON.parse(str);
var selRegiones = $('#regiones');
var selProvincias = $('#provincias');
var selComunas = $('#comunas');
var jsonRegiones = json.regiones;
var regionesOptions = "";

$.each(jsonRegiones, function(k, v) {
  regionesOptions += `<option value="${k}">${v.NombreRegion}</option>`;
});
  selRegiones.append(regionesOptions);

$(selRegiones).on('change', function() {

  selProvincias.find("option:not(:first)").remove();
  selComunas.find("option:not(:first)").remove();
  var provinciasOptions = "";
  var jsonProvincias = jsonRegiones[this.value].provincias;

  $.each(jsonProvincias, function(k, v) {
    $.each(v, function(provincia, comuna) {
      provinciasOptions += `<option value="${k}">${provincia}</option>`;
    });
  });

  selProvincias.append(provinciasOptions);

});

$(selProvincias).on('change', function() {

  selComunas.find("option:not(:first)").remove();
  var indexRegion = selRegiones.find(":selected").val();
  var keyProvincia = selProvincias.find(":selected").text();
  var arrComunas = jsonRegiones[indexRegion].provincias[this.value][keyProvincia];
  var comunasOptions = "";
  $.each(arrComunas, function(k, v) {
    comunasOptions += `<option value="${k}">${v}</option>`;
  });

  selComunas.append(comunasOptions);

});
    </script>
</html>
